W=(...w)=>I(4,_=>m[h]+=(x>>w[i]&1)*3<<i*2)|++h
I(8192,i=>m[C+i]=0)
m[P]=252
m[X]=m[Y]=-30
z=2
J(2,12,_=>m[B+j+i*32]=z++)
m[B+12]=1
h=C+16
F(r,b=>W(4,5,6,7,x=b)|W(0,1,2,3))
F(l,b=>J(2,2,_=>W(a=6-4*i,a,++a,a,x=b)|W(a-=3,a,++a,a)))
m[V]=_=>--m[Y]